(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[592],{5695:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Conducteur",function(){return l(9483)}])},9483:function(e,a,l){"use strict";l.r(a);var t=l(5893),s=l(5678),r=l(7294),i=l(5121),n=l(1163),c=l(3832),o=l(1552),d=l(1594),u=l(7769),x=l(2318),p=l(2472);a.default=()=>{let[e,a]=(0,r.useState)(0),l=["Information Personnelles","Documents","D\xe9tails V\xe9hicule"],[m,h]=(0,r.useState)(!1),checkChauffeur=async()=>{try{let e=await fetch("http://localhost:3005/Chauff/checkchauffeur",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:L,phone:B,cnicNo:ex,phoneCode:eB})}),a=await e.json();if(a.exists)return"permisNumber"===a.duplicateField?(ew("Ce num\xe9ro de permis existe d\xe9j\xe0"),e_(""),eN("")):"email"===a.duplicateField?(eN("Cet email existe d\xe9j\xe0"),ew(""),e_("")):"phone"===a.duplicateField&&(e_("Ce num\xe9ro de t\xe9l\xe9phone existe d\xe9j\xe0"),ew(""),eN("")),!1;return!0}catch(e){return console.error("Error checking chauffeur:",e),!1}},handleNext=async()=>{if(0===e){if(!M||!F||!L||!ex||!B||!ee||!ec||!em||!eb||!el||!es||!ei||!eB){eC(M?"":"Veuillez entrer votre Nom"),eq(F?"":"Veuillez entrer votre Pr\xe9nom"),eN(L?"":"Veuillez entrer votre Email"),ew(ex?"":"Veuillez entrer votre Num\xe9ro de Permis"),e_(B?"":"Veuillez entrer votre Num\xe9ro de T\xe9l\xe9phone"),eE(ee?"":"Veuillez s\xe9lectionner votre Civilit\xe9"),eA(ec?"":"Veuillez entrer votre Date de Naissance"),eI(em?"":"Veuillez entrer votre Adresse"),eR(eb?"":"Veuillez entrer votre Code Postal"),ef(el?"":"Veuillez entrer votre Ville"),eZ(es?"":"Veuillez entrer votre Pays"),eP(ei?"":"Veuillez s\xe9lectionner votre Type de Chauffeur"),eY(eB?"":"Requis");return}let e=await checkChauffeur();e&&a(e=>e+1)}else if(1===e){eJ(!0);try{await handleSubmit(),a(e=>e+1)}catch(e){console.error("Error in handleSubmit:",e)}finally{eJ(!1)}}},[b,g]=(0,r.useState)(),[j,f]=(0,r.useState)(),[v,N]=(0,r.useState)(),[y,w]=(0,r.useState)({file:[]}),[S,C]=(0,r.useState)({file:[]}),[k,q]=(0,r.useState)(""),[V,P]=(0,r.useState)(""),[z,_]=(0,r.useState)(""),[D,E]=(0,r.useState)(""),[T,Z]=(0,r.useState)(""),[M,A]=(0,r.useState)(),[F,I]=(0,r.useState)(),[L,R]=(0,r.useState)(),[B,O]=(0,r.useState)(),[X,Y]=(0,r.useState)({file:[]}),[H,J]=(0,r.useState)({file:[]}),[U,G]=(0,r.useState)({file:[]}),[K,Q]=(0,r.useState)({file:[]}),[W,$]=(0,r.useState)({file:[]}),[ee,ea]=(0,r.useState)(),[el,et]=(0,r.useState)(),[es,er]=(0,r.useState)(),[ei,en]=(0,r.useState)(),[ec,eo]=(0,r.useState)(),[ed,eu]=(0,r.useState)(),[ex,ep]=(0,r.useState)(),[em,eh]=(0,r.useState)(),[eb,eg]=(0,r.useState)(),[ej,ef]=(0,r.useState)(""),[ev,eN]=(0,r.useState)(""),[ey,ew]=(0,r.useState)(""),[eS,eC]=(0,r.useState)(""),[ek,eq]=(0,r.useState)(""),[eV,eP]=(0,r.useState)(""),[ez,e_]=(0,r.useState)(""),[eD,eE]=(0,r.useState)(""),[eT,eZ]=(0,r.useState)(""),[eM,eA]=(0,r.useState)(""),[eF,eI]=(0,r.useState)(""),[eL,eR]=(0,r.useState)(""),[eB,eO]=(0,r.useState)(""),[eX,eY]=(0,r.useState)(""),[eH,eJ]=(0,r.useState)(!1),[eU,eG]=(0,r.useState)(!1),[eK,eQ]=(0,r.useState)([]),[eW,e$]=(0,r.useState)(null);(0,n.useRouter)(),(0,r.useEffect)(()=>{fetch("https://restcountries.com/v3.1/all").then(e=>e.json()).then(e=>{let a=e.map(e=>{var a,l;return{value:e.name.common,label:(null===(a=e.idd)||void 0===a?void 0:a.root)?"".concat(e.idd.root).concat(e.idd.suffixes?e.idd.suffixes[0]:""):"",icon:null===(l=e.flags)||void 0===l?void 0:l.png}}).filter(e=>e.label),l=a.sort((e,a)=>e.value.localeCompare(a.value));eQ(l)}).catch(e=>console.error("Error fetching countries:",e))},[]),(0,r.useEffect)(()=>{console.log("Updated chauffId:",b)},[b]);let handleSubmit=async e=>{e.preventDefault(),console.log("handleSubmit function is called");let l="".concat(eB).concat(B);eJ(!0);try{let e=await i.Z.post("http://localhost:3005/Chauff/AjoutChauf",{Nom:M,Prenom:F,email:L,fullPhoneNumber:l,photoAvatar:X,photoCin:W,photoPermisRec:H,photoPermisVer:U,photoVtc:K,civilite:ee,DateNaissance:ec,Nationalite:ed,cnicNo:ex,address:em,postalCode:eb,ville:el,pays:es,typeChauffeur:ei},{headers:{"Content-Type":"multipart/form-data"}});e.data.uses,A(""),I(""),R(""),O(""),document.getElementById("login").reset(),ea(""),eo(""),eu(""),ep(""),eh(""),eg(""),eN(""),e_(""),ew(""),eY("");let t=e.data;g(t),a(e=>e+1)}catch(e){console.warn(e),e.response?(403===e.response.status?(eN("l'email existe d\xe9j\xe0"),s.Am.error("".concat(ev))):eN(""),e.response.data.phoneExists?(e_("Phone already exists"),s.Am.error("".concat(ez))):e_(""),e.response.data.cinExists?(ew("CIN already exists"),s.Am.error("".concat(ey))):ew("")):s.Am.error("Merci de verifier vos donn\xe9es")}finally{eJ(!1)}},handleCarDetailsSubmit=async e=>{e.preventDefault(),console.log("handleCarDetailsSubmit function is called"),q(""),P(""),_(""),E("");let l=!1;if(j||(q("L'immatriculation est requise."),l=!0),v||(P("Le mod\xe8le est requis."),l=!0),S&&S instanceof File&&0!==S.size||(E("La photo de la carte grise est requise."),l=!0),y&&y instanceof File&&0!==y.size||(_("La photo de l'assurance est requise."),l=!0),!l){eG(!0);try{await i.Z.post("http://localhost:3005/Voi/addvoiture/".concat(b),{photoCartegrise:S,photoAssurance:y,immatriculation:j,modelle:v},{headers:{"Content-Type":"multipart/form-data"}}),Z("Merci Pour Votre inscription votre dossier sera trait\xe9 dans les prochains jours"),f(""),N(""),a(e=>e+1)}catch(e){console.warn(e)}finally{eG(!1)}}};return(0,t.jsx)(c.Z,{children:eU?(0,t.jsx)("div",{class:"flex items-center w-full justify-center text-center min-h-screen ",children:(0,t.jsxs)("div",{class:"text-2xl font-semibold text-gray-800 text-center animate-pulse",children:["Veuillez patienter un moment pendant que nous traitons votre demande. ",(0,t.jsx)("br",{}),(0,t.jsx)("span",{class:"text-gold",children:"Chargement en cours..."})]})}):(0,t.jsx)("div",{children:(0,t.jsx)("form",{action:"",id:"login",method:"post",onSubmit:handleSubmit,children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-4 py-24",children:[(0,t.jsxs)("p",{className:"text-3xl text-center font-light text-gray-600",children:["Vous souhaitez nous Rejoindre ?",(0,t.jsx)("br",{}),"Veuillez Remplir Le Formulaire ci-dessous avec vos informations"]}),T&&(0,t.jsx)("div",{className:"flex justify-center items-center mt-4",children:(0,t.jsx)("p",{className:"text-green-500 bg-white border border-green-500 rounded-lg py-2 px-4",children:T})}),(0,t.jsx)(o.Z,{activeStep:e,children:l.map(e=>(0,t.jsx)(d.Z,{children:(0,t.jsx)(u.Z,{children:e})},e))}),(0,t.jsxs)("div",{className:"container mx-auto px-16  lg:grid-cols-2",children:[0===e&&(0,t.jsxs)("div",{children:[(0,t.jsx)(x.Z,{variant:"h5",gutterBottom:!0,children:"Informations Personnelles"}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1  p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Civilit\xe9"}),(0,t.jsxs)("select",{id:"civilite",className:"text-gray-900 block w-full p-2.5",onChange:e=>ea(e.target.value),value:ee||"",required:!0,children:[(0,t.jsx)("option",{value:"",children:"S\xe9lectionner"}),(0,t.jsx)("option",{value:"Mr",children:"Homme"}),(0,t.jsx)("option",{value:"Mme",children:"Femme"})]}),eD&&(0,t.jsx)("label",{className:"text-red-500",children:eD})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1 p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Nom"}),(0,t.jsx)("input",{type:"text",id:"nom",className:"text-gray-900 block w-full p-2.5",placeholder:"NOM",onChange:e=>A(e.target.value),value:M||"",required:!0}),eS&&(0,t.jsx)("label",{className:"text-red-500",children:eS})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1 p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Pr\xe9nom"}),(0,t.jsx)("input",{type:"text",id:"prenom",className:"text-gray-900 block w-full p-2.5",placeholder:"Pr\xe9nom",onChange:e=>I(e.target.value),value:F||"",required:!0}),ek&&(0,t.jsx)("label",{className:"text-red-500",children:ek})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1 p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Date de Naissance"}),(0,t.jsx)("input",{type:"date",id:"dateNaissance",className:"text-gray-900 block w-full p-2.5",onChange:e=>eo(e.target.value),value:ec||"",max:(()=>{let e=new Date,a=new Date(e.getFullYear()-18,e.getMonth(),e.getDate()),l=a.getFullYear(),t=a.getMonth()+1;t<10&&(t="0".concat(t));let s=a.getDate();return s<10&&(s="0".concat(s)),"".concat(l,"-").concat(t,"-").concat(s)})(),required:!0}),eM&&(0,t.jsx)("label",{className:"text-red-500",children:eM})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1  p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Num Permis"}),(0,t.jsx)("input",{type:"number",id:"cin",className:"text-gray-900 block w-full p-2.5",placeholder:"012345678",onChange:e=>ep(e.target.value),value:ex||"",required:!0}),ey&&(0,t.jsx)("label",{className:"text-red-500",children:ey})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1 p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Email"}),(0,t.jsx)("input",{type:"email",id:"email",className:"text-gray-900 block w-full p-2.5",placeholder:"name@gmail.com",onChange:e=>R(e.target.value),value:L||"",required:!0}),ev&&(0,t.jsx)("label",{className:"text-red-500",children:ev})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1 p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"T\xe9l\xe9phone"}),(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsxs)("select",{id:"phoneCode",className:"block w-36 p-2.5 border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 mr-2",onChange:e=>eO(e.target.value),value:eB||"",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Choisir le code"}),eK.map(e=>(0,t.jsxs)("option",{value:e.label,children:[e.value," ",e.label]},e.value))]}),(0,t.jsx)("input",{type:"number",id:"phone",className:"text-gray-900 block w-full p-2.5 border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"012345678",onChange:e=>O(e.target.value),value:B||"",required:!0})]}),(0,t.jsxs)("div",{className:"flex gap-28",children:[eX&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:eX}),ez&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:ez})]})]}),(0,t.jsxs)("div",{className:"flex justify-between ",children:[(0,t.jsxs)("div",{className:"col-span-1 row-span-1 p-4 px-8 border-l",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Adresse"}),(0,t.jsx)("input",{type:"text",id:"adresse",className:"text-gray-900 block w-full p-2.5",placeholder:"Adresse",onChange:e=>eh(e.target.value),value:em||"",required:!0}),eF&&(0,t.jsx)("label",{className:"text-red-500",children:eF})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1 p-4 px-8  ",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Ville"}),(0,t.jsx)("input",{type:"text",id:"ville",className:"text-gray-900 block w-full p-2.5",placeholder:"Ville",onChange:e=>et(e.target.value),value:el||"",required:!0})," ",ej&&(0,t.jsx)("label",{className:"text-red-500",children:ej})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1 p-4 px-8 border-r",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Pays"}),(0,t.jsx)("input",{type:"text",id:"pays",className:"text-gray-900 block w-full p-2.5",placeholder:"Pays",onChange:e=>er(e.target.value),value:es||"",required:!0}),eT&&(0,t.jsx)("label",{className:"text-red-500",children:eT})]})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1 p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Code Postal"}),(0,t.jsx)("input",{type:"number",id:"codePostal",className:"text-gray-900 block w-full p-2.5",placeholder:"Code Postal",onChange:e=>eg(e.target.value),value:eb||"",required:!0})," ",eL&&(0,t.jsx)("label",{className:"text-red-500",children:eL})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1  p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Type de Chauffeur"}),(0,t.jsxs)("select",{id:"typeChauffeur",className:"text-gray-900 block w-full p-2.5",onChange:e=>en(e.target.value),value:ei||"",required:!0,children:[(0,t.jsx)("option",{value:"",children:"S\xe9lectionner"}),(0,t.jsx)("option",{value:"Chauffeur priv\xe9",children:"Chauffeur Priv\xe9"}),(0,t.jsx)("option",{value:"Chauffeur Taxi",children:"Chauffeur Taxi"})]}),eV&&(0,t.jsx)("label",{className:"text-red-500",children:eV})]})]}),1===e&&(0,t.jsxs)("div",{children:[(0,t.jsx)(x.Z,{variant:"h5",gutterBottom:!0,children:"Documents"}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1  p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Visage"}),(0,t.jsx)("input",{type:"file",id:"avatar",className:"text-gray-900 block w-full p-2.5",onChange:e=>Y(e.target.files[0]),required:!0})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1  p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"CIN"}),(0,t.jsx)("input",{type:"file",id:"photo_cin",className:"text-gray-900 block w-full p-2.5",onChange:e=>$(e.target.files[0]),required:!0})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1  p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:" VTC"}),(0,t.jsx)("input",{type:"file",id:"photo_VTC",className:"text-gray-900 block w-full p-2.5",onChange:e=>Q(e.target.files[0]),required:!0})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1  p-4 px-8 border",children:[(0,t.jsxs)("label",{className:"block mb-2 text-gray-900",children:[" ","Permis Recto"]}),(0,t.jsx)("input",{type:"file",id:"permis_recto",className:"text-gray-900 block w-full p-2.5",onChange:e=>G(e.target.files[0]),required:!0})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1  p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Permis Verso"}),(0,t.jsx)("input",{type:"file",id:"permis_verso",className:"text-gray-900 block w-full p-2.5",onChange:e=>J(e.target.files[0]),required:!0})]})]}),2===e&&(0,t.jsxs)("div",{children:[(0,t.jsx)(x.Z,{variant:"h5",gutterBottom:!0,children:"D\xe9tails V\xe9hicule"}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1  p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Immatriculation"}),(0,t.jsx)("input",{type:"text",id:"immatriculation",className:"text-gray-900 block w-full p-2.5",placeholder:"Immatriculation",value:j,onChange:e=>f(e.target.value),required:!0}),k&&(0,t.jsx)("label",{className:"text-red-500 ",children:k})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1  p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Modelle"}),(0,t.jsx)("input",{type:"text",id:"modelle",className:"text-gray-900 block w-full p-2.5",placeholder:"Modelle",value:v,onChange:e=>N(e.target.value),required:!0}),V&&(0,t.jsx)("label",{className:"text-red-500 ",children:V})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1  p-4 px-8 border",children:[(0,t.jsxs)("label",{className:"block mb-2 text-gray-900",children:[" ","Cartegrise"]}),(0,t.jsx)("input",{type:"file",id:"categrise",className:"text-gray-900 block w-full p-2.5",onChange:e=>C(e.target.files[0]),required:!0}),D&&(0,t.jsx)("label",{className:"text-red-500 ",children:D})]}),(0,t.jsxs)("div",{className:"col-span-1 row-span-1  p-4 px-8 border",children:[(0,t.jsx)("label",{className:"block mb-2 text-gray-900",children:"Assurance"}),(0,t.jsx)("input",{type:"file",id:"assurance",className:"text-gray-900 block w-full p-2.5",onChange:e=>w(e.target.files[0]),required:!0}),z&&(0,t.jsx)("label",{className:"text-red-500 ",children:z})]})]})]}),(0,t.jsx)("div",{className:"mt-2",children:e===l.length?(0,t.jsx)("div",{children:(0,t.jsx)(x.Z,{variant:"h5",gutterBottom:!0,children:"Merci pour nous rejoindre"})}):(0,t.jsxs)("div",{children:[(0,t.jsx)(p.Z,{disabled:0===e,onClick:()=>{a(e=>e-1)},children:"Retour"}),e===l.length-2?(0,t.jsx)(p.Z,{id:"sub_btn",type:"submit",value:"login",variant:"contained",color:"primary",disabled:eH,children:eH?"Loading...":"Suivant"}):e===l.length-1?(0,t.jsx)(p.Z,{id:"sub_btn",type:"submit",value:"login",variant:"contained",color:"primary",onClick:e=>{handleCarDetailsSubmit(e)},disabled:eH,children:eH?"Loading...":"Rejoignez Nous"}):(0,t.jsx)(p.Z,{variant:"contained",color:"primary",onClick:handleNext,disabled:eH,children:eH?"Loading...":"Suivant"})]})})]})})})})}}},function(e){e.O(0,[121,666,774,888,179],function(){return e(e.s=5695)}),_N_E=e.O()}]);